name: 'Perform SAST scan'
description: 'Perform a SAST scan on Fortify on Demand'
author: 'Fortify'
runs:
  using: composite
  steps:
    - uses: patricioperezv/boaboa-fortify-action/internal/set-fod-var-defaults@v1.4.0
    - uses: patricioperezv/boaboa-fortify-action/setup@v1.4.0
      with:
        export-path: false
        fcli: action-default
    - uses: patricioperezv/boaboa-fortify-action/internal/fod-login@v1.4.0
    - uses: patricioperezv/boaboa-fortify-action/package@v1.4.0
    - uses: patricioperezv/boaboa-fortify-action/internal/run-script@v1.4.0
      with:
        script: fod-scan.sh
      env: 
        DO_SAST_SCAN: true # Not used for now
        GITHUB_TOKEN: ${{ github.token }}
    - if: env.DO_EXPORT == 'true'
      uses: patricioperezv/boaboa-fortify-action/fod-export@v1.4.0
        
branding:
  icon: 'shield'
  color: 'blue'

